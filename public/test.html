<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Player</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
        }
        video {
            width: 80%;
            max-width: 800px;
            margin-top: 20px;
        }
        .video-details {
            margin-top: 20px;
        }
    </style>
</head>
<body>

<h1>Live Video Player</h1>

<div id="video-container">
    <video id="video-player" controls>
        <source id="video-source" type="application/x-mpegURL">
        Your browser does not support the video tag.
    </video>
    <div class="video-details">
        <h2 id="channel-name"></h2>
        <p id="channel-owner"></p>
    </div>
</div>

<script>
    // URL of the JSON API
    const apiUrl = "https://raw.githubusercontent.com/byte-capsule/TSports-m3u8-Grabber/main/TSports_m3u8_headers.Json";

    // Function to fetch the data and set up the video player
    async function setupVideoPlayer() {
        try {
            // Fetch the JSON data
            const response = await fetch(apiUrl);
            const data = await response.json();

            // Get the first channel's video link and headers
            const channel = data.channels[0];
            const videoLink = channel.link;
            const headers = channel.headers;

            // Set video source URL
            const videoSource = document.getElementById("video-source");
            videoSource.src = videoLink;

            // Set video details
            document.getElementById("channel-name").innerText = channel.name;
            document.getElementById("channel-owner").innerText = `Owner: ${data.owner}`;

            // Set up the video player to use the correct headers
            const videoPlayer = document.getElementById("video-player");

            // Add custom headers for the video request
            const init = {
                method: "GET",
                headers: new Headers({
                    "Cookie": headers.Cookie,
                    "Host": headers.Host,
                    "User-Agent": headers["User-agent"]
                })
            };

            // Set the video player's source with custom headers
            fetch(videoLink, init)
                .then(() => {
                    // If the video is available, start the player
                    videoPlayer.load();
                    videoPlayer.play();
                })
                .catch((error) => {
                    console.error("Error loading video:", error);
                    alert("Failed to load video.");
                });

        } catch (error) {
            console.error("Error fetching JSON data:", error);
            alert("Failed to load channel data.");
        }
    }

    // Call the setup function to initialize the video player
    setupVideoPlayer();
</script>

</body>
</html>

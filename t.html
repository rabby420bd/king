<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TSports Video Player</title>
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      background-color: #000;
    }
    video {
      width: 80%;
      max-width: 800px;
      height: auto;
      background-color: #000;
    }
  </style>
</head>
<body>
  <video id="video" controls autoplay></video>
  <script>
    async function fetchStreamDetails() {
      const apiUrl = 'https://raw.githubusercontent.com/byte-capsule/TSports-m3u8-Grabber/main/NS_Player_Tsports_live.m3u';

      try {
        // Fetch the JSON data from the API
        const response = await fetch(apiUrl);
        const data = await response.json();

        // Extract the required fields
        const m3u8Link = data[1].link;
        const headers = {
          'Origin': data[1].origin,
          'Referer': data[1].referrer,
          'User-Agent': data[1].userAgent,
          'Cookie': data[1].cookie,
        };

        // Load the video using HLS.js
        const video = document.getElementById('video');
        if (Hls.isSupported()) {
          const hls = new Hls({
            xhrSetup: function(xhr, url) {
              // Add custom headers to the request
              xhr.setRequestHeader('Origin', headers['Origin']);
              xhr.setRequestHeader('Referer', headers['Referer']);
              xhr.setRequestHeader('User-Agent', headers['User-Agent']);
              xhr.setRequestHeader('Cookie', headers['Cookie']);
            },
          });

          hls.loadSource(m3u8Link);
          hls.attachMedia(video);

          hls.on(Hls.Events.MANIFEST_PARSED, function() {
            console.log('Video loaded successfully!');
            video.play();
          });
        } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
          // For Safari
          video.src = m3u8Link;
          video.play();
        } else {
          alert('HLS is not supported in this browser.');
        }
      } catch (error) {
        console.error('Error fetching video details:', error);
        alert('Failed to load the video. Please try again later.');
      }
    }

    // Fetch video details on page load
    fetchStreamDetails();
  </script>
</body>
</html>
